# Dash-CPP-Merge

这个项目是将dash-cpp和dash-cpp-main两个Shell系统整合而成的增强版Shell实现，结合了两个系统的所有优点，并使用全中文输出。

## 主要特性

1. **完整的Shell基础功能**
   - 命令执行与管道
   - 输入/输出重定向
   - 变量管理
   - 命令行解析

2. **强大的作业控制**
   - 前台/后台作业执行
   - 作业状态监控
   - 信号处理
   - 进程组管理

3. **丰富的内置命令**
   - 基本命令：cd, pwd, echo, exit
   - 作业控制：bg, fg, jobs
   - 进程管理：kill, wait
   - 工具命令：debug, help, history, source

4. **开发者友好功能**
   - 调试模式
   - 命令历史记录
   - 帮助系统
   - 脚本执行

5. **中文用户界面**
   - 所有提示与错误信息使用中文
   - 友好的用户体验

## 系统架构

该系统采用层次化设计，结合了面向对象和函数式编程的优点：

```
                  +-------------+
                  |    Shell    |
                  +-------------+
                  |
         +--------+---------+
         |                  |
+--------v-------+  +-------v--------+
|   Parser &     |  |  JobControl    |
|    Lexer       |  |                |
+----------------+  +-------+--------+
                            |
                    +-------v--------+
                    | BGJobAdapter   |
                    +-------+--------+
                            |
                    +-------v--------+
                    |bg_job_control  |
                    |    (C API)     |
                    +----------------+
```

### 任务管理双层架构

项目整合了两种任务管理实现：

1. **C++ 面向对象任务管理**
   - `JobControl`类：高级作业控制
   - `Job`/`Process`类：作业和进程抽象

2. **C 风格后台任务控制**
   - `bg_job_control` API：高性能底层实现
   - `BGJobAdapter`：C++适配器，提供更友好的接口

这种双层设计充分利用了C风格API的高性能和C++面向对象的可维护性。

## 用法

### 基本使用

```bash
# 交互式模式
./dash

# 执行命令
./dash -c "echo 你好，世界"

# 执行脚本
./dash script.sh
```

### 作业控制

```bash
# 后台运行命令
./dash
$ sleep 100 &
[1] 12345

# 查看作业
$ jobs
[1]+  运行中      sleep 100 &

# 将作业放入前台
$ fg %1
sleep 100
^C  # 使用Ctrl+C终止

# 等待作业完成
$ sleep 50 &
[1] 12346
$ wait %1
```

### 调试模式

```bash
$ debug on
调试模式已启用

$ debug parser on
解析器调试模式已启用
```

## 构建

```bash
mkdir build && cd build
cmake ..
make
```

## 依赖项

- C++17 兼容编译器
- CMake 3.10 或更高版本
- GNU Readline 库

## 内置命令

- `bg [作业ID]`：在后台继续运行已停止的作业
- `cd [目录]`：改变当前目录
- `debug [on|off]`：启用或禁用调试信息
- `echo [参数...]`：显示参数
- `exit [状态码]`：退出shell
- `fg [作业ID]`：将作业移到前台并继续运行
- `help [命令]`：显示帮助信息
- `history [参数]`：显示命令历史
- `jobs [-p] [-l]`：显示活动作业
- `kill [-s 信号] ID`：发送信号给进程或作业
- `pwd`：显示当前工作目录
- `source 文件`：执行脚本文件中的命令
- `wait [作业ID]`：等待后台作业完成

## 贡献

欢迎提交Pull Request来改进这个项目！ 